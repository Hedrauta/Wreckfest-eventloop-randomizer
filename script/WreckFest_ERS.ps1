[System.Array]$Script:rmaps = @('speedway2_figure_8', 'dirt_speedway_figure_8', 'speedway1_figure_8', 'fields12_2', 'bigstadium_figure_8', 'fig8_boom', 'fig8_derbybankedeight', 'fig8_derbybankedeightbigramp', 'fig8_derbybankedeightnoramp', 'fig8_derbybankedeightsafe', 'fig8_elevatedeight', 'fig8_harbor_04', 'fig8_hurtfullfive', 'fig8_nfd', 'fig8_rpar2017', 'fig8_scac', 'fig8_wimbledonfig8', 'gardemoen_fig8', 'colosseum_event_01', 'coyote_fig8', 'stadium_eight_halfpipe', 'stadium_eight_loop', 'stadium_eight_main', 'stadium_eight_oval', 'stadium_eight_square', 'tunnel_s03', 'speedway2_inner_oval', 'speedway2_outer_oval', 'dirt_speedway_dirt_oval', 'speedway1_oval', 'fields12_1', 'fields12_1_rev', 'fields10_1', 'fields09_1', 'forest12_1', 'forest12_1_rev', 'forest12_2', 'gardemoen_drag_oval', 'gardemoen_drag_oval_reverse', 'colosseum_event_11', 'colosseum_event_12', 'greenracing_crosskart_01', 'greenracing_crosskart_01_reverse', 'misc_harbor_02', 'ovals_ae', 'ovals_arendaltriangle', 'ovals_arendaltriangle_reverse', 'ovals_birkeland_oval01', 'ovals_bristol', 'ovals_bristol_banger', 'ovals_bristol_dirt', 'ovals_emmenraceway', 'ovals_harbor_07', 'ovals_hillsideraceway', 'ovals_kingslynn', 'ovals_knobhill_oval', 'ovals_knobhill_oval_reverse', 'ovals_lakewood', 'ovals_michiganspeedway', 'ovals_nfdovaljump', 'ovals_os', 'ovals_osm', 'ovals_osr', 'ovals_oss', 'ovals_pennsboro', 'ovals_pennsboro_reverse', 'ovals_pennsboro_minioval', 'ovals_pennsboro_minioval_reverse', 'ovals_phr', 'ovals_phrr', 'ovals_ringwood', 'ovals_rpa_oval', 'ovals_rwro', 'ovals_rwror', 'ovals_rwr_minioval', 'ovals_talledega', 'ovals_wimbledon', 'coyote_oval', 'coyote_oval_reverse', 'city_s04', 'city_s04_reverse', 'city_s09', 'city_s09_reverse', 'sandpit3_short_loop', 'sandpit3_short_loop_rev', 'tarmac3_main_circuit', 'tarmac3_main_circuit_rev', 'tarmac1_main_circuit', 'tarmac1_main_circuit_rev', 'tarmac1_short_circuit', 'tarmac1_short_circuit_rev', 'mixed7_r1', 'mixed7_r1_rev', 'mixed7_r2', 'mixed7_r2_rev', 'urban08_1', 'urban08_1_rev', 'gravel1_main_loop', 'gravel1_main_loop_rev', 'mixed5_outer_loop', 'mixed5_outer_loop_rev', 'mixed5_inner_loop', 'mixed5_inner_loop_rev', 'mixed5_free_route', 'mixed3_long_loop', 'mixed3_long_loop_rev', 'mixed3_short_loop', 'mixed3_short_loop_rev', 'mixed3_r3', 'mixed3_r3_rev', 'fields14_1', 'fields14_2', 'mixed4_main_circuit', 'mixed4_main_circuit_rev', 'sandpit1_long_loop', 'sandpit1_long_loop_rev', 'sandpit1_short_loop', 'sandpit1_short_loop_rev', 'sandpit1_alt_loop', 'sandpit1_alt_loop_rev', 'sandpit2_full_circuit', 'sandpit2_full_circuit_rev', 'sandpit2_2', 'sandpit2_2_rev', 'fields13_1', 'fields13_1_rev', 'gardemoen_head-on', 'gardemoen_head-on_reverse', 'misc_bugbearisland', 'misc_bugbearislandreverse', 'misc_dunerace', 'misc_dunerace_reverse', 'misc_knockhill', 'misc_knockhill_reverse', 'misc_kristiansandraceway', 'misc_kristiansandracewayreverse', 'misc_harbor_01', 'misc_pitstop', 'misc_rwr_tour', 'misc_sca', 'misc_sca_fast', 'pocono_oval', 'pocono_oval_reverse', 'pocono_route_3', 'pocono_route_3_reverse', 'pocono_route_4', 'pocono_route_4_reverse', 'rallycross_knockhill_rc_long', 'rallycross_knockhill_rc_long_reverse', 'city_s01', 'city_s01_reverse', 'city_s07', 'city_s07_reverse', 'crm01_1', 'crm01_5', 'sandpit3_long_loop', 'sandpit3_long_loop_rev', 'crm02_1', 'tarmac2_main_circuit', 'tarmac2_main_circuit_rev', 'tarmac2_main_circuit_tourney', 'misc_space_s1', 'misc_sfs', 'pocono_route_1', 'pocono_route_1_reverse', 'pocono_route_2', 'pocono_route_2_reverse', 'pocono_route_5', 'pocono_route_5_reverse', 'city_s02', 'city_s02_reverse', 'laguna_main', 'laguna_reverse', 'palmer_main', 'palmer_reverse', 'tunnel_s01', 'tunnel_s02', 'tunnel_s04', 'mixed9_r1', 'mixed9_r1_rev', 'triangle_r1', 'fields08_1', 'fields08_1_rev', 'tarmac3_short_circuit', 'tarmac3_short_circuit_rev', 'mixed1_main_circuit', 'mixed1_main_circuit_rev', 'mixed7_r3', 'mixed7_r3_rev', 'mixed2_main_circuit', 'mixed2_main_circuit_rev', 'mixed8_r1', 'mixed8_r2', 'mixed8_r3_rev', 'forest13_1', 'forest13_1_rev', 'forest13_2', 'forest13_2_rev', 'forest11_1', 'forest11_1_rev', 'forest11_2', 'forest11_2_rev', 'gardemoen_zigzag', 'gardemoen_zigzag_reverse', 'colosseum_event_06', 'colosseum_event_07', 'grenland_fast', 'grenland_fast_reverse', 'grenland_folkrace', 'grenland_folkrace_reverse', 'grenland_chicane', 'grenland_chicane_reverse', 'grenland_head_on', 'grenland_joker', 'grenland_joker_reverse', 'lyngas_lyngas_fast', 'lyngas_lyngas_fast_reverse', 'lyngas_lyngas_original', 'lyngas_lyngas_original_reverse', 'lyngas_lyngas_slow', 'lyngas_lyngas_slow_reverse', 'misc_bsv', 'misc_bsv_reverse_day', 'misc_ccr', 'misc_ccr_reverse', 'misc_ccr_ramp', 'misc_ccr_ramp_reverse', 'misc_cc2017', 'misc_eaglesnest', 'misc_harbor_03', 'misc_harbor_06', 'misc_woodhillraceway', 'pocono_route_6', 'pocono_route_6_reverse', 'rallycross_aremark', 'rallycross_aremark_reverse', 'rallycross_bronnoy', 'rallycross_bronnoy_long', 'rallycross_bronnoy_reverse', 'rallycross_knockhill_rc_short', 'rallycross_knockhill_rc_short_reverse', 'rallycross_lupineshill', 'rallycross_rugsland', 'rallycross_rugsland_reverse', 'rallycross_rwrr', 'rallycross_rwrrr', 'rallycross_simstoxshowdown', 'asan_main', 'asan_rain', 'asan_rain_evening', 'asan_reverse', 'coyote_rallycross', 'coyote_rallycross_reverse', 'city_s03', 'city_s03_reverse', 'city_s06', 'city_s08', 'city_s08_reverse', 'city_s10', 'gardemoen', 'gardemoen_reverse', 'gardemoen_open', 'gardemoen_rallycross', 'gardemoen_rallycross_reverse', 'laanke_open', 'laanke_rallycross', 'laanke_rallycross_reverse', 'laanke_short', 'laanke_short_reverse', 'laanke_tarmac', 'laanke_tarmac_reverse', 'primm', 'primm_reverse', 'tomelilla_01', 'tomelilla_02', 'tomelilla_03', 'tomelilla_04', 'tomelilla_05', 'whp', 'whp_reverse', 'whp_wet', 'rt01_1', 'farmlands_s1', 'farmlands_s1_reverse', 'farmlands_s2', 'farmlands_s2_reverse', 'farmlands_s3', 'farmlands_s3_reverse', 'farmlands_s4', 'farmlands_s4_reverse', 'farmlands_s5', 'farmlands_s5_reverse', 'gardemoen_dragstrip', 'gardemoen_dragstrip_long', 'gardemoen_dragstrip_chicane', 'misc_birkeland', 'misc_birkeland_reverse', 'misc_dakar_s01', 'misc_dakar_s02_drag', 'misc_dakar_s03', 'misc_dakar_s04', 'misc_dakar_s05_dragstorm', 'misc_dakar_s06_storm', 'coyote_dragstrip', 'coyote_dragstrip_alt', 'speedway2_oval_loop', 'bonebreaker_valley_main_circuit', 'crash_canyon_main_circuit', 'loop', 'urban06', 'urban09_1', 'colosseum_event_04', 'colosseum_event_10', 'misc_bridgetonowhere', 'misc_crashalley', 'misc_nfdhighspeed', 'misc_nfdwarehouserun', 'misc_rbrace', 'speedway2_oval_loop';'loop';'triangle_r1';'crash_canyon_main_circuit';'bonebreaker_valley_main_circuit';'fields09_1';'forest12_2';'urban06';'sandpit2_2';'sandpit2_2_rev';'tarmac3_short_circuit';'tarmac3_short_circuit_rev';'mixed1_main_circuit';'mixed1_main_circuit_rev';'mixed2_main_circuit';'mixed2_main_circuit_rev';'mixed7_r3';'mixed7_r3_rev';'mixed9_r1';'mixed9_r1_rev';'mixed8_r2';'mixed8_r3_rev';'fields08_1';'fields08_1_rev';'orest11_1';'forest11_1_rev';'forest11_2';'forest11_2_rev';'sandpit1_long_loop';'sandpit1_long_loop_rev';'sandpit1_alt_loop';'sandpit1_alt_loop_rev';'sandpit2_full_circuit';'sandpit2_full_circuit_rev';'sandpit3_long_loop';'sandpit3_long_loop_rev';'sandpit3_short_loop';'sandpit3_short_loop';'tarmac1_main_circuit';'tarmac1_main_circuit_rev';'tarmac2_main_circuit';'tarmac2_main_circuit_rev';'tarmac3_main_circuit';'tarmac3_main_circuit_rev';'mixed3_long_loop';'mixed3_long_loop_rev';'mixed5_outer_loop';'mixed5_outer_loop_rev';'mixed5_inner_loop';'mixed5_inner_loop_rev';'mixed5_free_route';'urban08_1';'urban08_1_rev';'fields13_1_rev';'fields13_1';'gravel1_main_loop';'gravel1_main_loop_rev ';'sandpit1_short_loop';'sandpit1_short_loop_rev';'tarmac1_short_circuit';'tarmac1_short_circuit_rev';'mixed3_short_loop';'mixed3_short_loop_rev';'mixed4_main_circuit';'mixed4_main_circuit_rev';'mixed7_r1';'mixed7_r1_rev';'mixed8_r1';'dirt_speedway_dirt_oval';'speedway1_oval';'speedway2_inner_oval';'speedway2_outer_oval';'bigstadium_figure_8';'speedway1_figure_8';'speedway2_figure_8';'dirt_speedway_figure_8';'fields12_2')
# defined Racing-maps, for later use
[System.Array]$Script:dmaps = @('urban07';'fields10_2';'fields11_1';'bigstadium_demolition_arena';'field_derby_arena';'mudpit_demolition_arena';'grass_arena_demolition_arena';'smallstadium_demolition_arena';'fields13_2';'triangle_r2';'speedway2_demolition_arena';'speedway2_classic_arena')
# defined Demolition-Maps
[System.Array]$Script:maps = @('speedway2_oval_loop';'loop';'triangle_r1';'crash_canyon_main_circuit';'bonebreaker_valley_main_circuit';'fields09_1';'forest12_2';'urban06';'sandpit2_2';'sandpit2_2_rev';'tarmac3_short_circuit';'tarmac3_short_circuit_rev';'mixed1_main_circuit';'mixed1_main_circuit_rev';'mixed2_main_circuit';'mixed2_main_circuit_rev';'mixed7_r3';'mixed7_r3_rev';'mixed9_r1';'mixed9_r1_rev';'mixed8_r2';'mixed8_r3_rev';'fields08_1';'fields08_1_rev';'orest11_1';'forest11_1_rev';'forest11_2';'forest11_2_rev';'sandpit1_long_loop';'sandpit1_long_loop_rev';'sandpit1_alt_loop';'sandpit1_alt_loop_rev';'sandpit2_full_circuit';'sandpit2_full_circuit_rev';'sandpit3_long_loop';'sandpit3_long_loop_rev';'sandpit3_short_loop';'sandpit3_short_loop';'tarmac1_main_circuit';'tarmac1_main_circuit_rev';'tarmac2_main_circuit';'tarmac2_main_circuit_rev';'tarmac3_main_circuit';'tarmac3_main_circuit_rev';'mixed3_long_loop';'mixed3_long_loop_rev';'mixed5_outer_loop';'mixed5_outer_loop_rev';'mixed5_inner_loop';'mixed5_inner_loop_rev';'mixed5_free_route';'urban08_1';'urban08_1_rev';'fields13_1_rev';'fields13_1';'gravel1_main_loop';'gravel1_main_loop_rev ';'sandpit1_short_loop';'sandpit1_short_loop_rev';'tarmac1_short_circuit';'tarmac1_short_circuit_rev';'mixed3_short_loop';'mixed3_short_loop_rev';'mixed4_main_circuit';'mixed4_main_circuit_rev';'mixed7_r1';'mixed7_r1_rev';'mixed8_r1';'dirt_speedway_dirt_oval';'speedway1_oval';'speedway2_inner_oval';'speedway2_outer_oval';'bigstadium_figure_8';'speedway1_figure_8';'speedway2_figure_8';'dirt_speedway_figure_8';'fields12_2';'urban07';'fields10_2';'fields11_1';'bigstadium_demolition_arena';'field_derby_arena';'mudpit_demolition_arena';'grass_arena_demolition_arena';'smallstadium_demolition_arena';'fields13_2';'triangle_r2';'speedway2_demolition_arena';'speedway2_classic_arena')
[System.Array]$Script:dmodes = @('derby';'derby deathmatch';'team derby')
[System.Array]$Script:rmodes = @('racing';'team race';'elimination race')
[System.Array]$Script:eli_secs = @('0';'20';'30';'45';'60';'90';'120')
[System.Array]$Script:derby_secs = @('2';'4';'6';'8';'10';'12';'14';'16';'18';'20')
# yeah!!!... gamemodes!!! 
Write-Host " █████   ███   █████                             █████         ██████                    █████   "
Write-Host "░░███   ░███  ░░███                             ░░███         ███░░███                  ░░███    "
Write-Host "░███   ░███   ░███  ████████   ██████   ██████  ░███ █████  ░███ ░░░   ██████   █████  ███████  "
Write-Host "░███   ░███   ░███ ░░███░░███ ███░░███ ███░░███ ░███░░███  ███████    ███░░███ ███░░  ░░░███░   "
Write-Host "░░███  █████  ███   ░███ ░░░ ░███████ ░███ ░░░  ░██████░  ░░░███░    ░███████ ░░█████   ░███    "
Write-Host " ░░░█████░█████░    ░███     ░███░░░  ░███  ███ ░███░░███   ░███     ░███░░░   ░░░░███  ░███ ███"
Write-Host "   ░░███ ░░███      █████    ░░██████ ░░██████  ████ █████  █████    ░░██████  ██████   ░░█████ "
Write-Host "    ░░░   ░░░      ░░░░░      ░░░░░░   ░░░░░░  ░░░░ ░░░░░  ░░░░░      ░░░░░░  ░░░░░░     ░░░░░"
Write-Host "Eventloop-Randomizer-Script"

Write-Host "Preparing types"
# Start fetching files

[System.Collections.ArrayList]$Script:types = $(Get-ChildItem -Exclude WreckFest_ERS.ps1,eventloop.txt,WreckfestERS.cer)

if ( $types.Count -eq 0  ){
    Write-Warning "No files found. Please define the maps into files or download the predefined ones from the GitHub"
    #Exit
    Break
}

$types | ForEach-Object{ $_ | Add-Member -MemberType NoteProperty -Name Set1 -Value 0 } # Adding first kind of settings to Array and set to 0 for later use
$types | ForEach-Object{ $_ | Add-Member -MemberType NoteProperty -Name Set2 -Value 0 } # second kind of settings ( elimination-secs or number of teams )
$types | ForEach-Object{ $_ | Add-Member -MemberType NoteProperty -Name Maps -Value @() } #Adding empty Array for maps. Filled with maps laterly
$types | ForEach-Object{ $_ | Add-Member -MemberType NoteProperty -Name Maps_Array -Value @() } #Adding empty Array for maps. Filled with maps laterly
$types | ForEach-Object{ $_ | Add-Member -MemberType NoteProperty -Name rmode -Value "none" } # separate race from demo-modes
$types | ForEach-Object{ $_ | Add-Member -MemberType NoteProperty -Name dmode -Value "none" }

# define functions
function load_maps($a) {
    Write-Host "`n$($($a).Name) found"
            $rh_l = $null
            do {
                $rh_l = Read-Host -Prompt "Do you want load $($a.Name)? [y/n]"
                if ($rh_l -eq 'y'){
                    [System.Collections.Generic.List[System.Object]]$($a).Maps =  Get-Content $($($a))
                    [System.Array]$($a).Maps_Array =  Get-Content $($($a))
                    $($a).Maps_Array | ForEach-Object  {
                        if ($maps.Contains("$($_)") -eq $FALSE){
                            $a.Maps.Remove($_) | Out-Null 
                            Write-Host "$($_) is not part of the offical maplist. Removed Entry from Randomizer"
                            sleep -Milliseconds 500
                        }
                    }
                    [System.Array]$($a).Maps_Array = $($a).Maps # for use in further functions
        }
    } until ($rh_l -eq 'y' -or $rh_l -eq 'n')
}
function mc_race($a) {
    $rh_l = $null
    $($a).Maps_Array | ForEach-Object {
    if ($rmodes.Contains("$($a.rmode)") -eq $False) {
        if ($rmaps.Contains("$($_)") -eq $TRUE){
            ""
            Write-Host "Racing maps found"
            ""
            while ($rmodes.Contains("$($rh_l)") -eq $FALSE) {
                Write-Host "Racing-gamemodes: 'team race' ; 'elimination race' ; 'racing'"
                $rh_l = Read-Host -Prompt "Enter Gamemode"
            }
            ""
            $a.rmode = $rh_l
            if ($rh_l -eq "racing") {
                $rh_m = 0
                while ($($rh_m -ge 1 -and $rh_m -le 60) -eq $FALSE) {
                    try {[int]$rh_m = Read-Host -Prompt "Enter Number of Laps for choosen mode [1-60]"}
                    catch {Write-Warning "Please enter a valid number"}
                }
                $a.Set1 = $rh_m
                Write-Host "$($rh_m) lap(s) set"
            }
            if ($rh_l -eq "team race") {
                $rh_m = 0
                $rh_n = $null
                while ($($rh_m -ge 2 -and $rh_m -le 4) -eq $FALSE) {
                    try{[int]$rh_m = Read-Host -Prompt "Enter Number of Teams [2-4]"}
                    catch {Write-Warning "Please enter a valid number"}
                }
                ""
                $a.Set2 = $rh_m
                Write-Host "$($rh_m) Teams set."
                while ($($rh_n -ge 1 -and $rh_n -le 60) -eq $FALSE) {
                    try{[int]$rh_n = Read-Host -Prompt "Set Number of laps [1-60]"}
                    catch {Write-Warning "Please enter a valid number"}
                }
                ""
                $a.Set1 = $rh_n
                Write-Host "$($rh_n) lap(s) set"
            }
            if ($rh_l -eq "elimination race") {
                $a.Set1 = 1
                $rh_m = $null
                ""
                while ($eli_secs.Contains("$($rh_m)") -eq $FALSE){
                    Write-Host "$($eli_secs)"
                    $rh_m = Read-Host "Choose seconds of elimination from above (0=every round)"
                    if ($eli_secs.Contains("$($rh_m)") -eq $FALSE) {
                        Write-Warning "Only Pick one of the following numbers"
                        $rh_m = $null
                    }
                }
                $a.Set2 = $rh_m
                Write-Host "$($rh_m) seconds set"
            }
        }
    }
    }
}
function mc_demo($a) {
    $rh_l = $null
    $($a).Maps_Array | ForEach-Object {
    if ($dmodes.Contains("$($a.dmode)") -eq $False) {
        if ($dmaps.Contains("$($_)") -eq $TRUE){
            ""
            Write-Host "Demolition-maps found"
            While ($dmodes.Contains("$($rh_l)") -eq $FALSE){
                Write-Host "Demolition-gamemodes: 'derby' (Last man Standing) ; 'derby deathmatch' ; 'team derby'"
                $rh_l = Read-Host -Prompt "Enter Gamemode"
            }
            ""
            if ($dmodes.Contains("$($rh_l)") -eq $TRUE) {
                $a.dmode = $rh_l
                if ($rh_l -eq 'derby') {
                    $a.Set1 = 1
                    Write-Host "Last man Standing picked. No further setup"
                }
                if ($rh_l -eq 'derby deathmatch') {
                    $rh_m = $null
                    while ($derby_secs.Contains("$($rh_m)") -eq $FALSE) {
                        ""
                        Write-Host "$($derby_secs)"
                        $rh_m = Read-Host -Prompt "Pick time in minutes from above"
                        ""
                        if ($derby_secs.Contains("$($rh_m)") -eq $False) {
                            Write-Warning "Wrong Number picked. Please enter a correct Value"
                            $rh_m = $null
                        }
                    }
                    $a.Set1 = $rh_m
                    Write-Host "$($rh_m) minutes set."
                }
                if ($rh_l -eq 'team derby') {
                    $rh_m = $null
                    $rh_n = $null
                    while ($derby_secs.Contains("$($rh_m)") -eq $FALSE) {
                        Write-Host "$($derby_secs)"
                        $rh_m = Read-Host -Prompt "Pick time in minutes from above"
                        ""
                        if ($derby_secs.Contains("$($rh_m)") -eq $FALSE) {
                            Write-Warning "Wrong Number picked. Please enter a correct value"
                            $rh_m = $null
                        }
                    }
                    $a.Set1 = $rh_m
                    Write-Host "$($rh_m) minutes set."
                    while ($($rh_n -ge 2 -and $rh_n -le 4) -eq $FALSE) {
                        try{[int]$rh_n = Read-Host -Prompt "Pick number of teams [2-4]"}
                        catch {Write-Warning "Please enter a valid value"}
                    }
                    $a.Set2 = $rh_n
                    Write-Host "$($rh_n) teams set."
                }
            }
        }
        }
    }
}
function count_maps {
    $count_maps = 0
    for ($i=0;$i -le $($types.Count - 1);$i++){
        $count_maps += $types[$i].Maps.Count
    }
    Write-Host "$($count_maps) Maps left"
    [int]$Script:count_m = $count_maps
}
function random_file {
    if ($count_m -gt 1) {
        $rand = Get-Random -Minimum 1 -Maximum $count_m
        $cup = 0
        for ($i=0; $rand -ge $cup; $i++) {
            $cup += $types[$i].Maps.Count
            if ($rand -le $cup) {
                $Script:p = $i
            }
        }
    }
    else {$Script:p = 0}
    
}
function random_map {
    $Script:map = $null
    if ($types[$p].Maps.Count -gt 1) {
        $Script:map = Get-Random -InputObject $types[$p].Maps
    }
    else {$Script:map = $types[$p].Maps[0]}
}
function reload_or_remove { # Check if content of object is empty. Ask for Reload, or remove if not.
    for ($i=0; $i -le $($types.Count - 1) ; $i++){
        if ($($types[$i].Set1) -ge 1 -and $($types[$i].Maps.Count) -eq 0){
            Write-Host "$($types[$i].BaseName)-Maps are empty." 
            do {
                $rh_rm = $null
                $rh_rm = Read-Host -Prompt "Do you want to load $($($types[$i]).Name) again? [y/n]" 
                if ($rh_rm -eq 'y'){
                    [System.Collections.Generic.List[System.Object]]$($types[$i]).Maps =  $types[$i].Maps_Array 
                    Write-Host "$($types[$i].Maps.Count) Maps reloaded"
                }
                if ($rh_rm -eq 'n'){ 
                    $types[$i].Set1 = 0
                }
            } until ($rh_rm -eq 'y' -or $rh_rm -eq 'n')
        }
        if ($($($types[$i]).Set1) -eq 0){ 
            $types.RemoveAt($i) | Out-Null
        }
    }
}
function write_file {
    "el_add=$Script:map" | Out-File -FilePath .\eventloop.txt -Append
    "el_gamemode=$($types[$p].rmode)" | Out-File -FilePath .\eventloop.txt -Append
    if ($rmaps.Contains("$($map)") -eq $true){
        if ($types[$p].rmode -eq "racing") {
            "el_laps=$($types[$p].Set1)" | Out-File -FilePath .\eventloop.txt -Append
        }
        if ($types[$p].rmode -eq "team race") {
            "el_num_teams=$($types[$p].Set2)" | Out-File -FilePath .\eventloop.txt -Append
            "el_laps=$($types[$p].Set1)" | Out-File -FilePath .\eventloop.txt -Append
        }
        if ($types[$p].rmode -eq "elimination race") {
            "el_elimination_interval=$($types[$p].Set2)" | Out-File -FilePath .\eventloop.txt -Append
        }
    }
    if ($dmaps.Contains("$($map)") -eq $true) {
        if ($types[$p].dmode -eq "derby deathmatch") {
            "el_time_limit=$($types[$p].Set1)" | Out-File -FilePath .\eventloop.txt -Append
        }
        if ($types[$p].dmode -eq "team derby") {
            "el_num_teams=$($types[$p].Set2)" | Out-File -FilePath .\eventloop.txt -Append
            "el_time_limit=$($types[$p].Set1)" | Out-File -FilePath .\eventloop.txt -Append
        }
    }
    "" | Out-File -FilePath .\eventloop.txt -Append
    $types[$p].Maps.Remove("$($Script:map)") | Out-Null
}

# Start Defining variables: loading maps, getting modes per file
for ($i=0; $i -le $($types.Count - 1) ; $i++) {
    load_maps $types[$i]
    mc_race $types[$i]
    mc_demo $types[$i]
}
Write-Host "Setup Complete. Start Randomizing <.<"
sleep -Milliseconds 500
"" | Out-File .\eventloop.txt
while ($types.Count -ge 1) {
    count_maps
    random_file
    random_map
    write_file
    reload_or_remove
}
"";"";""
Write-Host "Randomizing finished" # Finally!!! ""
do {
    $cl_c = Read-Host -Prompt "do you want the loop copied into your Clipboard? [y/n] " # faster copy-paste for you
    if ($cl_c -eq 'y'){
        Get-Content .\eventloop.txt | Set-Clipboard
    }
} until ($cl_c -eq 'y' -or $cl_c -eq 'n')

"";"";"" # DONE!!!
Write-Host "Thanks for using my Script."
Write-Host "Keep updated on https://github.com/Hedrauta/wreckfest-eventloop-randomizer for new features, updates or if you have new ideas"
""
Write-Host "This script is licensed under MIT. For more Informations, please visit my Github (link above)"
Sleep -Seconds 5

# Please do not edit or remove the following lines. It'll need the WreckfestERS.crt installed on your PC to run properly
# SIG # Begin signature block
# MIIFZAYJKoZIhvcNAQcCoIIFVTCCBVECAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUysE5bYoqC+7ewOnT10SSsUAh
# kGGgggMCMIIC/jCCAeagAwIBAgIQSb1S4BP9Rr1Bp3x2CHYX6jANBgkqhkiG9w0B
# AQsFADAXMRUwEwYDVQQDDAxXcmVja2Zlc3RFUlMwHhcNMjEwMjEwMTYxOTIyWhcN
# MjIwMjEwMTYzOTIyWjAXMRUwEwYDVQQDDAxXcmVja2Zlc3RFUlMwggEiMA0GCSqG
# SIb3DQEBAQUAA4IBDwAwggEKAoIBAQC5H52vw2/ilgWc3Q1eFu7xsJdhmopeQ+hI
# d7U9+qCRBvgx9mXJX0NKwvloy8IwDCea2CUXXaFQFIACdyb/+FYjusDUGcXc8Nz9
# u1mAVpYTxzcweqQSntdY7IBUiXQnJcxGRKtjmKc3/N/OK9ZX2Y8E/4YKFw50TVnE
# 0Z25zIKJvZa9ue02kIW+l/ukAP+sql6Sq/zX7p/fyXf5KcuLdRvHEkiT1CZLav8n
# uV9REmJo+EMORIHAqwPfeUojAOpqg29eHDP5Q1xIjQlYFaQY54mOedpaRdy+Cwex
# Rw3AP2fu1+ZtX/y6J+NxJQDQADRdYvhsXl+CWey833B/dQlk8F4JAgMBAAGjRjBE
# MA4GA1UdDwEB/wQEAwIHgDATBgNVHSUEDDAKBggrBgEFBQcDAzAdBgNVHQ4EFgQU
# MACzacu3u7dO4GAnC8++1eCLCccwDQYJKoZIhvcNAQELBQADggEBAJPE3UZP9p+u
# I3ai4kSpzrrX7j2PqYmUUEacRviboaaV1dlrH/vSiAy3ejeY3N6gvvsr1WBdC0Dx
# JHrV9IvOepmqLK1GI3Nzuez0r/6ws+MIBvbbtgWiGAz3YvlCa3AF8Q+ueixSJV8H
# RGB4mqIzF/PZEW2EOJaUTS5HNhJTdVmDpfkKL/0BYpp9JVOI6Iy01On7OTDDFvGO
# NMND/F/TNmEsi1t7Uz1UBvSZr73/7FuSBkNGRJqEz16INgVEfKk9dzp7qj5k6x66
# IPbHkSZVGy/f6mY6D6BxM+vjf6cGd1YMFU5aa9dg/DGmK87g1xNTtvAaGRZEiAtd
# Ok2qbomaTfwxggHMMIIByAIBATArMBcxFTATBgNVBAMMDFdyZWNrZmVzdEVSUwIQ
# Sb1S4BP9Rr1Bp3x2CHYX6jAJBgUrDgMCGgUAoHgwGAYKKwYBBAGCNwIBDDEKMAig
# AoAAoQKAADAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgEL
# MQ4wDAYKKwYBBAGCNwIBFTAjBgkqhkiG9w0BCQQxFgQUtXEa/LEBgCB7KwaPS7X7
# whFO52EwDQYJKoZIhvcNAQEBBQAEggEAsK7SdFpk3XsrtZgsgpuvg0+l8M1o+xZu
# yJ5f6pv5P/cpfCuUD0TH38H5rKRm1uxhBXEAhBq/C7amwLZiKGIMGkLS3nBXm1sC
# tO4ojRxOVRh8Epwh1fvxXhE1h+6o/iywrOYeaLDME7NDhl3BDLQA26qPQkmKXczA
# rMLsJeYoOGB6mdfS9BDb8Ram68PrDaKPdQLrhonxRXJmN90pe14vGuuepy/zMQBf
# BD8Qzix6+QJkoWPyFz4ZLaGE9oaDUnAHwVIwJ3X/dOFoB9lO9843db1G2z9qWPOq
# mu7wywLL/AJYyoVVgj92JOBiOHcJKy6Cs9EeOnlDtSkKpeD8L/z5wA==
# SIG # End signature block
